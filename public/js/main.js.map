{"version":3,"sources":["main.js"],"names":["width","height","color","d3","scale","category20","force","layout","charge","linkDistance","size","svg","select","append","attr","json","error","services","tmpnodes","links","forEach","e","target","b","_id","source","push","id","name","properties","exists","nodes","undefined","graph","drawGraph","start","link","selectAll","data","enter","style","d","Math","sqrt","value","gnodes","classed","group","call","drag","text","on","x","y"],"mappings":"AAAA,YACA,IAAIA,OAAQ,IACRC,OAAS,IAETC,MAAQC,GAAGC,MAAMC,aAEjBC,MAAQH,GAAGI,OAAOD,QACjBE,OAAO,MACPC,aAAa,KACbC,MAAMV,MAAOC,SAEdU,IAAMR,GAAGS,OAAO,oBAAoBC,OAAO,OAC1CC,KAAK,QAASd,OACdc,KAAK,SAAUb,OAEpBE,IAAGY,KAAK,QAAS,SAASC,EAAOC,GAC/B,GAAID,EAAO,KAAMA,EAGjB,IAAIE,MACAC,IAEJF,GAASG,QAAQ,SAASC,GACxB,GAAIC,GAASD,EAAEE,EAAEC,IACbC,EAASJ,EAAEJ,SAASO,GACxBL,GAAMO,MAAMD,OAAQA,EAAQH,OAAQA,IAEpCJ,EAASQ,MAAMC,GAAML,EAAQM,KAAQP,EAAEE,EAAEM,WAAWD,OACpDV,EAASQ,MAAMC,GAAMF,EAAQG,KAAQP,EAAEJ,SAASY,WAAWD,QAG7D,IAAIE,MACAC,IACJb,GAASE,QAAQ,SAASC,GACJW,QAAhBF,EAAOT,EAAEM,MACXI,EAAML,KAAKL,GACXS,EAAOT,EAAEM,KAAM,IAInB,IAAIM,IAASF,MAAOA,EAAOZ,MAAOA,GAG9Be,EAAY,SAASD,GAEvB3B,MACKyB,MAAME,EAAMF,OACZZ,MAAMc,EAAMd,OACZgB,OAEL,IAAIC,GAAOzB,IAAI0B,UAAU,SACpBC,KAAKL,EAAMd,OACboB,QAAQ1B,OAAO,QACbC,KAAK,QAAS,QACd0B,MAAM,eAAgB,SAASC,GAAK,MAAOC,MAAKC,KAAKF,EAAEG,SAExDC,EAASlC,IAAI0B,UAAU,WACvBC,KAAKL,EAAMF,OACXQ,QACA1B,OAAO,KACPiC,QAAQ,SAAS,EAEVD,GAAOhC,OAAO,UACpBC,KAAK,QAAS,QACdA,KAAK,IAAK,IACV0B,MAAM,OAAQ,SAASC,GAAK,MAAOvC,OAAMuC,EAAEM,SAC3CC,KAAK1C,MAAM2C,MAGHJ,EAAOhC,OAAO,QACtBqC,KAAK,SAAST,GAAK,MAAOA,GAAEb,MAGjCtB,OAAM6C,GAAG,OAAQ,WACff,EAAKtB,KAAK,KAAM,SAAS2B,GAAK,MAAOA,GAAEhB,OAAO2B,IACzCtC,KAAK,KAAM,SAAS2B,GAAK,MAAOA,GAAEhB,OAAO4B,IACzCvC,KAAK,KAAM,SAAS2B,GAAK,MAAOA,GAAEnB,OAAO8B,IACzCtC,KAAK,KAAM,SAAS2B,GAAK,MAAOA,GAAEnB,OAAO+B,IAE9CR,EAAO/B,KAAK,YAAa,SAAS2B,GAC9B,MAAO,cAAgBA,EAAEW,EAAGX,EAAEY,GAAK,QAM3CnB,GAAUD","file":"main.js","sourcesContent":["// Graph\nvar width = 980,\n    height = 500;\n\nvar color = d3.scale.category20();\n\nvar force = d3.layout.force()\n    .charge(-120)\n    .linkDistance(150)\n    .size([width, height]);\n\nvar svg = d3.select(\".graph-container\").append(\"svg\")\n    .attr(\"width\", width)\n    .attr(\"height\", height);\n\nd3.json(\"/info\", function(error, services) {\n  if (error) throw error;\n\n  // Format json output \n  var tmpnodes = [];\n  var links = [];\n\n  services.forEach(function(e) {\n    var target = e.b._id;\n    var source = e.services._id;\n    links.push({source: source, target: target});\n\n    tmpnodes.push({\"id\": target, \"name\": e.b.properties.name});\n    tmpnodes.push({\"id\": source, \"name\": e.services.properties.name});\n  });\n\n  var exists = [];\n  var nodes = [];\n  tmpnodes.forEach(function(e) {\n    if (exists[e.id] == undefined) {\n      nodes.push(e);\n      exists[e.id] = true;\n    }\n  });\n\n  var graph = {nodes: nodes, links: links};\n\n  // Graph setup  \n  var drawGraph = function(graph) {\n\n    force\n        .nodes(graph.nodes)\n        .links(graph.links)\n        .start();\n\n    var link = svg.selectAll(\".link\")\n        .data(graph.links)\n      .enter().append(\"line\")\n        .attr(\"class\", \"link\")\n        .style(\"stroke-width\", function(d) { return Math.sqrt(d.value); });\n\n    var gnodes = svg.selectAll('g.gnode')\n       .data(graph.nodes)\n       .enter()\n       .append('g')\n       .classed('gnode', true);\n      \n    var node = gnodes.append(\"circle\")\n        .attr(\"class\", \"node\")\n        .attr(\"r\", 18)\n        .style(\"fill\", function(d) { return color(d.group); })\n        .call(force.drag);\n\n    // Labels\n    var labels = gnodes.append(\"text\")\n        .text(function(d) { return d.name; });\n\n    // Nodes position\n    force.on(\"tick\", function() {\n      link.attr(\"x1\", function(d) { return d.source.x; })\n          .attr(\"y1\", function(d) { return d.source.y; })\n          .attr(\"x2\", function(d) { return d.target.x; })\n          .attr(\"y2\", function(d) { return d.target.y; });\n      \n      gnodes.attr(\"transform\", function(d) { \n          return 'translate(' + [d.x, d.y] + ')'; \n      });\n          \n    });\n  };\n\n  drawGraph(graph);\n\n});\n"],"sourceRoot":"/source/"}